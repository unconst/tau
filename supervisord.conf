; Tau Supervisord Configuration
; This file configures supervisord to manage the Tau agent process
;
; Supervisor runs as a user-space process (no root required)
; and provides:
;   - Automatic restart on crash
;   - Process monitoring
;   - Simple restart commands via supervisorctl
;
; Management commands:
;   tauctl status   - Check if tau is running
;   tauctl restart  - Restart tau
;   tauctl stop     - Stop tau
;   tauctl start    - Start tau
;   tauctl logs     - View tau logs

[unix_http_server]
file=%(here)s/.supervisor.sock

[supervisord]
logfile=%(here)s/logs/supervisord.log
logfile_maxbytes=10MB
logfile_backups=3
loglevel=info
pidfile=%(here)s/.supervisord.pid
nodaemon=false
minfds=1024
minprocs=200
directory=%(here)s

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix://%(here)s/.supervisor.sock

[program:tau]
command=%(here)s/.venv/bin/python -m tau
directory=%(here)s
autostart=true
autorestart=true
startsecs=5
startretries=3
stopwaitsecs=10
redirect_stderr=true
stdout_logfile=%(here)s/logs/tau.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
environment=HOME="%(ENV_HOME)s",PATH="%(here)s/.venv/bin:%(ENV_HOME)s/.local/bin:%(ENV_HOME)s/.cursor/bin:/usr/local/bin:/usr/bin:/bin"
